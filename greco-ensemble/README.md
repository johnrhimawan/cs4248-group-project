# Ensembling with GRECO

## Install GRECO with Dependencies

Do the following steps on Soc Compute Cluster:

- Clone [GRECO](https://github.com/nusnlp/greco) from GitHub (you can also use a local version of GRECO, located [here](../greco/)).
- Modify and copy `install.sh` to the root of GRECO. For example, if GRECO is located at your home directory:

```bash
cp install.sh ~/greco
```

- Go to the root of GRECO, and run `install.sh` there:

```bash
cd ~/greco
sbatch install.sh
```

## Ensemble Corrections from Two Models

**Before starting:** make sure that you have the corrections generated by two baseline models written to some files.

Do the following steps on SoC Compute Cluster:

- Go to the root of GRECO, and active Python virtual environment:

```bash
cd ~/greco
source .venv/bin/activate
```

- Provide the paths to the original source file and the two correction files in `test.py`:

```python
source_file = "<path to the orignal source>"
hypotheses_file_1 = "<path to the corrections of model 1>"
hypotheses_file_2 = "<path to the corrections of model 2>"
```

- Provide the paths to the final ensemble output file and the two score files in `test.py`:

```python
output_file = "<path to the final ensemble>"
output_file_1 = "<path to the score of model 1's corrections>"
output_file_2 = "<path to the score of model 2's corrections>"
```

- Modify and run `test_script.sh`:

```bash
sbatch test_script.sh
```

The directory `ensemble-output` contains past ensembling results of T5-XL and T5-XXL on bea19 and conll14.
